<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>StrikerZone Football Shop</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    * { box-sizing: border-box; font-family: Arial, sans-serif; }
    body { margin: 0; padding: 0; background: #f9f9f9; color: #333; }
    header { background: #1a73e8; color: white; padding: 1rem; text-align: center; }
    main { padding: 1rem; max-width: 800px; margin: auto; }
    .section { margin-bottom: 2rem; background: #fff; padding: 1rem; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    h2 { color: #1a73e8; }
    input, button, select { padding: 0.5rem; margin: 0.5rem 0; width: 100%; border: 1px solid #ccc; border-radius: 4px; }
    button { background: #1a73e8; color: white; border: none; cursor: pointer; }
    button:hover { background: #155ab6; }
    .admin-panel, .wishlist, .shop, .inventory, .promo, .wallet { display: none; }
    .product { border: 1px solid #ddd; padding: 0.5rem; margin: 0.5rem 0; border-radius: 4px; }
    .logout { float: right; background: #ff4444; }
  </style>
</head>
<body>
<header>
  <h1>StrikerZone Football Shop</h1>
  <button id="logoutBtn" class="logout">Logout</button>
</header>
<main>
  <!-- Login/Signup -->
  <div class="section" id="auth">
    <h2>Login / Sign Up</h2>
    <input type="text" id="username" placeholder="Username">
    <input type="password" id="password" placeholder="Password">
    <button onclick="signup()">Sign Up</button>
    <button onclick="login()">Login</button>
  </div>

  <!-- Wallet -->
  <div class="section wallet" id="walletSection">
    <h2>Wallet: ₹<span id="wallet">0</span></h2>
  </div>

  <!-- Promo Codes -->
  <div class="section promo" id="promoSection">
    <h2>Enter Promo Code</h2>
    <input type="text" id="promoInput" placeholder="Enter promo code">
    <button onclick="redeemPromo()">Redeem</button>
  </div>

  <!-- Shop -->
  <div class="section shop" id="shopSection">
    <h2>Shop Products</h2>
    <div class="product">
      <strong>Football Boots - ₹300</strong>
      <button onclick="buy('Football Boots', 300)">Buy</button>
      <button onclick="addToWishlist('Football Boots')">Wishlist</button>
    </div>
    <div class="product">
      <strong>Goalkeeper Gloves - ₹200</strong>
      <button onclick="buy('Goalkeeper Gloves', 200)">Buy</button>
      <button onclick="addToWishlist('Goalkeeper Gloves')">Wishlist</button>
    </div>
  </div>

  <!-- Inventory -->
  <div class="section inventory" id="inventorySection">
    <h2>Inventory</h2>
    <ul id="inventoryList"></ul>
  </div>

  <!-- Wishlist -->
  <div class="section wishlist" id="wishlistSection">
    <h2>Wishlist</h2>
    <ul id="wishlistList"></ul>
  </div>

  <!-- Admin Panel -->
  <div class="section admin-panel" id="adminPanel">
    <h2>Admin Panel</h2>
    <p>View all registered users coming soon!</p>
  </div>
</main>


<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
  import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-auth.js";
  import { getFirestore, doc, setDoc, getDoc, updateDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDZNvRZ5wadbC4buX3RtcJnPgfTC_JwGNE",
    authDomain: "strikerzone-7.firebaseapp.com",
    projectId: "strikerzone-7",
    storageBucket: "strikerzone-7.firebasestorage.app",
    messagingSenderId: "637069505157",
    appId: "1:637069505157:web:96f13b53e8bc974c886fec",
    measurementId: "G-XZ6RXTW97Q"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  const walletEl = document.getElementById("wallet");
  const inventoryList = document.getElementById("inventoryList");
  const wishlistList = document.getElementById("wishlistList");
  const authDiv = document.getElementById("auth");
  const sections = ["walletSection", "shopSection", "promoSection", "inventorySection", "wishlistSection", "adminPanel"];

  let currentUser = null;

  document.getElementById("logoutBtn").onclick = () => {
    localStorage.clear();
    location.reload();
  };

  async function signup() {
    const username = document.getElementById("username").value;
    const pass = document.getElementById("password").value;
    const docRef = doc(db, "users", username);
    const docSnap = await getDoc(docRef);
    if (docSnap.exists()) {
      alert("User already exists!");
    } else {
      await setDoc(docRef, { password: pass, wallet: 0, inventory: [], wishlist: [] });
      alert("Signup successful! Please log in.");
    }
  }

  async function login() {
    const username = document.getElementById("username").value;
    const pass = document.getElementById("password").value;
    const docRef = doc(db, "users", username);
    const docSnap = await getDoc(docRef);
    if (docSnap.exists() && docSnap.data().password === pass) {
      currentUser = username;
      localStorage.setItem("user", username);
      loadUserData(docSnap.data());
      if (username === "atiksh" && pass === "atiksh7") show("adminPanel");
    } else {
      alert("Invalid credentials.");
    }
  }

  async function loadUserData(data) {
    authDiv.style.display = "none";
    sections.forEach(id => show(id));
    walletEl.textContent = data.wallet;
    inventoryList.innerHTML = data.inventory.map(item => `<li>${item}</li>`).join("");
    wishlistList.innerHTML = data.wishlist.map(item => `<li>${item}</li>`).join("");
  }

  async function buy(item, cost) {
    const userRef = doc(db, "users", currentUser);
    const userDoc = await getDoc(userRef);
    const data = userDoc.data();
    if (data.wallet >= cost) {
      data.wallet -= cost;
      data.inventory.push(item);
      await updateDoc(userRef, data);
      loadUserData(data);
      alert("Purchased!");
    } else {
      alert("Not enough balance.");
    }
  }

  async function redeemPromo() {
    const code = document.getElementById("promoInput").value.trim().toUpperCase();
    const promos = { "CR7GOAT": 100, "FIRE50": 50, "BIGBONUS": 500 };
    if (!promos[code]) return alert("Invalid promo code.");
    const userRef = doc(db, "users", currentUser);
    const userDoc = await getDoc(userRef);
    const data = userDoc.data();
    data.wallet += promos[code];
    await updateDoc(userRef, data);
    loadUserData(data);
    alert(`Promo applied! +₹${promos[code]}`);
  }

  async function addToWishlist(item) {
    const userRef = doc(db, "users", currentUser);
    const userDoc = await getDoc(userRef);
    const data = userDoc.data();
    if (!data.wishlist.includes(item)) {
      data.wishlist.push(item);
      await updateDoc(userRef, data);
      loadUserData(data);
    } else {
      alert("Already in wishlist.");
    }
  }

  function show(id) {
    document.getElementById(id).style.display = "block";
  }

  window.onload = async () => {
    const saved = localStorage.getItem("user");
    if (saved) {
      const docSnap = await getDoc(doc(db, "users", saved));
      if (docSnap.exists()) {
        currentUser = saved;
        loadUserData(docSnap.data());
        if (saved === "atiksh") show("adminPanel");
      }
    }
  };
</script>
</body>
</html>
